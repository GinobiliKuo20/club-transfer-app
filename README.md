# 學生轉社系統 (Student Club Transfer System)

這是一個基於 Python Streamlit 框架開發的網頁應用程式，用於自動化處理學生轉社的分發作業。

## 功能特色

*   **自動分發**：依照學生選填志願與「填寫時間」進行優先排序。
*   **動態遞補 (Ripple Effect)**：當學生成功轉出原社團時，系統會自動釋出該社團名額，並重新掃描候補名單，讓排在後面的學生有機會遞補。
*   **雙人交換機制**：分發結束後，系統會嘗試執行「雙人交換」，在不損害他人權益的前提下，提升（或持平）學生的志願滿意度。
*   **Excel 整合**：支援 Excel 檔案匯入學生資料與社團缺額，並可匯出完整的結果報表。
*   **資料隱私**：建議上傳前將姓名去識別化，下載後再自行對照。

## 安裝與執行

### 本地執行

1.  確保已安裝 Python 3.8 或以上版本。
2.  安裝必要套件：
    ```bash
    pip install -r requirements.txt
    ```
3.  啟動 Streamlit 伺服器：
    ```bash
    streamlit run app.py
    ```

### 部署至 Streamlit Cloud

1.  將本專案上傳至 GitHub。
2.  前往 [Streamlit Cloud](https://share.streamlit.io/) 並連結 GitHub 帳號。
3.  選擇本專案的 Repository，設定 Main file path 為 `app.py`。
4.  點擊 **Deploy** 即可獲得公開網址。

## 使用說明

1.  **準備資料**：
    *   **學生志願 Excel**：需包含欄位 `學號`, `姓名`, `填寫時間`, `原社團`, `志願1`...`志願10`。
    *   **社團缺額 Excel** (或是直接在網頁上輸入)：需包含 `社團名稱`, `目前缺額`。
2.  **上傳檔案**：在網頁左側 Sidebar 上傳準備好的 Excel 檔。
3.  **設定缺額**：確認社團缺額數據無誤。
4.  **開始分發**：點擊主畫面的「開始分發」按鈕。
5.  **查看與下載**：分發完成後，可檢視成功與失敗名單，並下載完整 Excel 報表。

## 演算法邏輯

1.  **時間優先**：以 `填寫時間` 為第一排序鍵值。
2.  **瀑布流遞補**：
    *   系統會不斷掃描所有學生，若發現學生的前順位志願有缺額（包含因他人轉出而釋出的名額），即進行移動。
    *   此過程會重複直到沒有任何學生可以再移動為止（Stable State）。
3.  **後期優化 (Post-Optimization)**：
    *   執行成對交換 (Pairwise Exchange)，檢查是否有任意兩位學生互換社團後，雙方都能獲得更好（或至少不變差）的結果。

## 注意事項

*   請確保 Excel 欄位名稱與上述要求完全一致。
*   由於使用雲端運算，建議上傳之 Excel 不包含敏感個資（如身分證字號），姓名可改用代號。
